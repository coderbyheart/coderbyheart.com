{"componentChunkName":"component---src-page-post-tsx","path":"/how-i-package-typescript-lambdas-for-aws","result":{"data":{"site":{"siteMetadata":{"title":"Markus Tacker","tagLine":"Software Crafter","description":"Software Crafter building ðŸŒ©ï¸ cloud-based cellular IoT solutions at Nordic Semiconductor.â€‹\n\t\tMentor. Speaker. â€‹Conference & Community builder. Camper. ðŸ•ï¸ ðŸš","gitHubUrl":"https://github.com/coderbyheart/coderbyheart.com.git","siteUrl":"https://coderbyheart.com","twitter":"@coderbyheart","defaultCard":"https://images.ctfassets.net/bncv3c2gt878/3Jk4P6nFPNzaz1gsguktk8/350b7e4ddb2c7d86416243d9902920e2/social-card-default-2020.png"}}},"pageContext":{"page":{"id":"86a67427-e0ce-5fc5-96e4-218a4a9f1d75","name":"how-i-package-typescript-lambdas-for-aws","relativeDirectory":"post","relativePath":"post/how-i-package-typescript-lambdas-for-aws.md","remark":{"htmlAst":{"children":[{"children":[{"properties":{"src":"//images.ctfassets.net/bncv3c2gt878/6wIvgQS4jGyGYsRVZylm14/fe8b7d7b0922f510df562c45bcb9d012/2019-04-25-how-i-package-typescript-lambdas-for-aws.jpg?w=5184&h=3456","alt":"Used Spray Cans"},"children":[],"tagName":"img","type":"element"}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[],"type":"text","value":"nRF Connect for Cloud"}],"tagName":"a","properties":{"href":"https://nrfcloud.com/","target":"_blank","rel":["nofollow","noreferrer"]},"type":"element"},{"children":[],"type":"text","value":" is an IoT product prototyping\nplatform built on top of AWS. It heavily uses serverless resources and all of\nour business logic is deployed using AWS Lambda. Per last count there were over\n100 lambdas which handle API requests, act based on MQTT messages, or run\nmaintenance operations."}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"While there are great solutions (like CloudFormation, or the even better\n"},{"children":[{"children":[],"type":"text","value":"CDK"}],"tagName":"a","properties":{"href":"https://github.com/awslabs/aws-cdk","target":"_blank","rel":["nofollow","noreferrer"]},"type":"element"},{"children":[],"type":"text","value":") to manage "},{"children":[{"children":[],"type":"text","value":"resources"}],"tagName":"em","properties":{},"type":"element"},{"children":[],"type":"text","value":" on AWS, when it\ncomes to publishing the program code for lambdas, the relevant documentation\nsection\n"},{"children":[{"children":[],"type":"text","value":"is rather sparse"}],"tagName":"a","properties":{"href":"https://docs.aws.amazon.com/lambda/latest/dg/nodejs-create-deployment-pkg.html","target":"_blank","rel":["nofollow","noreferrer"]},"type":"element"},{"children":[],"type":"text","value":".\nThis is understandable, though. AWS Lambda "},{"children":[{"children":[],"type":"text","value":"only"}],"tagName":"em","properties":{},"type":"element"},{"children":[],"type":"text","value":" provides computation resources\n(CPU, RAM) and does not care much how you use those resources in your code. It\nmakes actually very few assumptions about what you run and it supports\n"},{"children":[{"children":[],"type":"text","value":"any kind of language"}],"tagName":"a","properties":{"href":"https://docs.aws.amazon.com/lambda/latest/dg/runtimes-custom.html","target":"_blank","rel":["nofollow","noreferrer"]},"type":"element"},{"children":[],"type":"text","value":"."}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"This leaves a lot of room for "},{"children":[{"children":[],"type":"text","value":"many possible ways"}],"tagName":"em","properties":{},"type":"element"},{"children":[],"type":"text","value":" to solve publishing code to\nrun on AWS Lambda. Since I joined the team in 2017 I went over multiple\niterations on how lambdas are deployed. In this article I want to describe the\nlatest way I could come up with and what it provides for our scenario."}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[{"children":[],"tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"type":"element"}],"tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"type":"element"}],"tagName":"a","properties":{"href":"#external-dependencies-in-a-layer","ariaLabel":"external dependencies in a layer permalink","className":["anchor","before"]},"type":"element"},{"children":[],"type":"text","value":"External dependencies in a layer"}],"tagName":"h2","properties":{"id":"external-dependencies-in-a-layer","style":"position:relative;"},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"Our code depends on some rather big production dependencies. It needs to include\n"},{"children":[{"children":[{"children":[],"type":"text","value":"elasticsearch"}],"tagName":"code","properties":{},"type":"element"}],"tagName":"a","properties":{"href":"https://www.npmjs.com/package/elasticsearch","target":"_blank","rel":["nofollow","noreferrer"]},"type":"element"},{"children":[],"type":"text","value":" which adds a few\nmegabytes to the deployment package. In the past we used to pack lambdas with a\n"},{"children":[{"children":[],"type":"text","value":"package.json"}],"tagName":"code","properties":{},"type":"element"},{"children":[],"type":"text","value":" per lambda to at least not have to include the Elasticsearch\nclient in lambdas that do not talk to this database. Nevertheless this resulted\nin around 400MB in zipped deployment packages. It was reasonably fast (one\n"},{"children":[{"children":[],"type":"text","value":"npm ci --production"}],"tagName":"code","properties":{},"type":"element"},{"children":[],"type":"text","value":" per lambda, and a "},{"children":[{"children":[],"type":"text","value":"zip"}],"tagName":"code","properties":{},"type":"element"},{"children":[],"type":"text","value":"), but deploying this amount of\ndata can take time on slower connections, which can be annoying during\ndevelopment."}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"In the current approach I put all external dependencies for all lambdas in one\n"},{"children":[{"children":[],"type":"text","value":"Lambda Layer"}],"tagName":"a","properties":{"href":"https://docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html","target":"_blank","rel":["nofollow","noreferrer"]},"type":"element"},{"children":[],"type":"text","value":".\nThis one ZIP file is a little bigger (25 MB) than the biggest individual lambda\ndeployment package before (18MB), "},{"children":[{"children":[],"type":"text","value":"but"}],"tagName":"em","properties":{},"type":"element"},{"children":[],"type":"text","value":" I only need to publish this "},{"children":[{"children":[],"type":"text","value":"once"}],"tagName":"em","properties":{},"type":"element"},{"children":[],"type":"text","value":"."}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[{"children":[],"tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"type":"element"}],"tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"type":"element"}],"tagName":"a","properties":{"href":"#tree-shaking-on-inter-repo-dependencies","ariaLabel":"tree shaking on inter repo dependencies permalink","className":["anchor","before"]},"type":"element"},{"children":[],"type":"text","value":"Tree-Shaking on inter-repo dependencies"}],"tagName":"h2","properties":{"id":"tree-shaking-on-inter-repo-dependencies","style":"position:relative;"},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"For the individual lambda I use Webpack to compile it into a single module. I\n"},{"children":[{"children":[],"type":"text","value":"ignore all external modules"}],"tagName":"a","properties":{"href":"https://github.com/bifravst/package-layered-lambdas/blob/b8191d650a73d2eb208f4a90d46bb4e93db61782/src/packLambda.ts#L102","target":"_blank","rel":["nofollow","noreferrer"]},"type":"element"},{"children":[],"type":"text","value":"\nso the deployment package only contains the code that is actually required from\nthe repository. The typical size of the zipped lambda now is around 15KB. This\nresults in huge savings in the total deployments size. Including the layer this\nresults in less than 30MB. Which is more than 10 times less."}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[{"children":[],"tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"type":"element"}],"tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"type":"element"}],"tagName":"a","properties":{"href":"#deploy-only-if-changed","ariaLabel":"deploy only if changed permalink","className":["anchor","before"]},"type":"element"},{"children":[],"type":"text","value":"Deploy only if changed"}],"tagName":"h2","properties":{"id":"deploy-only-if-changed","style":"position:relative;"},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"It still takes time to build these deployment packages. That's why I use\n"},{"children":[{"children":[{"children":[],"type":"text","value":"dependency-tree"}],"tagName":"code","properties":{},"type":"element"}],"tagName":"a","properties":{"href":"https://www.npmjs.com/package/dependency-tree","target":"_blank","rel":["nofollow","noreferrer"]},"type":"element"},{"children":[],"type":"text","value":" to track the\ndependencies of each lambda and only rebuild it if one of the dependencies has\nchanged. This brings a great improvement for the developer. Previously I used to\nkeep deployment packages locally and would manually remove those that needed to\nbe rebuild. This is error-prone and regularly led to forgetting a certain lambda\nwhich was affected by the current edit. Since I now have a hash of all\ndependency, I can tell exactly which lambda needs to be rebuild when a source\nfile is changed. Checking the dependencies is reasonably fast (a few seconds) so\nI run it as part of our deployment command (hooked into "},{"children":[{"children":[],"type":"text","value":"npx cdk"}],"tagName":"code","properties":{},"type":"element"},{"children":[],"type":"text","value":")."}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[{"children":[],"tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"type":"element"}],"tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"type":"element"}],"tagName":"a","properties":{"href":"#cache-on-s3","ariaLabel":"cache on s3 permalink","className":["anchor","before"]},"type":"element"},{"children":[],"type":"text","value":"Cache on S3"}],"tagName":"h2","properties":{"id":"cache-on-s3","style":"position:relative;"},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"As an added bonus I publish all deployment packages on S3 (I need to do this for\nCDK anyway). And the deployment script will skip the packaging of a lambda if\nthat exact version has already been build. This means a developer can check out\nour repo and does not need to rebuild all lambdas in order to start working."}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[{"children":[],"tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"type":"element"}],"tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"type":"element"}],"tagName":"a","properties":{"href":"#source-code-and-usage-in-aws-cdk","ariaLabel":"source code and usage in aws cdk permalink","className":["anchor","before"]},"type":"element"},{"children":[],"type":"text","value":"Source code and usage in AWS CDK"}],"tagName":"h2","properties":{"id":"source-code-and-usage-in-aws-cdk","style":"position:relative;"},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"I have published the source code of the deployment script\n"},{"children":[{"children":[],"type":"text","value":"here"}],"tagName":"a","properties":{"href":"https://github.com/bifravst/package-layered-lambdas","target":"_blank","rel":["nofollow","noreferrer"]},"type":"element"},{"children":[],"type":"text","value":". The entry method is\n"},{"children":[{"children":[{"children":[],"type":"text","value":"packLayeredLambdas"}],"tagName":"code","properties":{},"type":"element"}],"tagName":"a","properties":{"href":"https://github.com/bifravst/package-layered-lambdas/blob/saga/src/packLayeredLambdas.ts","target":"_blank","rel":["nofollow","noreferrer"]},"type":"element"},{"children":[],"type":"text","value":"."}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"Since AWS CDK is building the Stack configuration through synchronously\nconstructing class instances we need to package the lambdas before we run\n"},{"children":[{"children":[],"type":"text","value":"new App()"}],"tagName":"code","properties":{},"type":"element"},{"children":[],"type":"text","value":"."}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[{"children":[],"tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"type":"element"}],"tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"type":"element"}],"tagName":"a","properties":{"href":"#cloudformationts","ariaLabel":"cloudformationts permalink","className":["anchor","before"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"cloudformation.ts"}],"tagName":"code","properties":{},"type":"element"}],"tagName":"h3","properties":{"id":"cloudformationts","style":"position:relative;"},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[{"children":[{"children":[],"type":"text","value":"import"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"*"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"as"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" fs "},{"children":[{"children":[],"type":"text","value":"from"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"fs\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"import"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"*"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"as"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" path "},{"children":[{"children":[],"type":"text","value":"from"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"path\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"import"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"{"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":" packBaseLayer "},{"children":[{"children":[],"type":"text","value":"}"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"from"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"@bifravst/package-layered-lambdas\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"import"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"{"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n  packLayeredLambdas"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n  WebpackMode"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"}"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"from"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"@bifravst/package-layered-lambdas\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n\n"},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"async"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"=>"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"{"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"// This is where we locally store the packaged lambdas"}],"tagName":"span","properties":{"className":["token","comment"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"const"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" outDir "},{"children":[{"children":[],"type":"text","value":"="}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" path"},{"children":[{"children":[],"type":"text","value":"."}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"resolve"}],"tagName":"span","properties":{"className":["token","function"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"__dirname"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"pack\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n\n  "},{"children":[{"children":[],"type":"text","value":"// Create the directory if it does not exist"}],"tagName":"span","properties":{"className":["token","comment"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"try"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"{"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    fs"},{"children":[{"children":[],"type":"text","value":"."}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"statSync"}],"tagName":"span","properties":{"className":["token","function"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"outDir"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"}"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"catch"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"_"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"{"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    fs"},{"children":[{"children":[],"type":"text","value":"."}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"mkdirSync"}],"tagName":"span","properties":{"className":["token","function"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"outDir"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"}"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n\n  "},{"children":[{"children":[],"type":"text","value":"// Set the name of the S3 bucket to store the lambdas"}],"tagName":"span","properties":{"className":["token","comment"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"// in reality we have another CDK App which provides this value,"}],"tagName":"span","properties":{"className":["token","comment"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"// but I have omitted it for the sakee of brevity"}],"tagName":"span","properties":{"className":["token","comment"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"const"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" bucketName "},{"children":[{"children":[],"type":"text","value":"="}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"cf-sourcecode\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n\n  "},{"children":[{"children":[],"type":"text","value":"// Location of the webpack config to use (see below)"}],"tagName":"span","properties":{"className":["token","comment"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"const"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" webpackConfig "},{"children":[{"children":[],"type":"text","value":"="}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" path"},{"children":[{"children":[],"type":"text","value":"."}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"resolve"}],"tagName":"span","properties":{"className":["token","function"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"__dirname"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"tsconfig-webpack.json\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n\n  "},{"children":[{"children":[],"type":"text","value":"// Location of the tsConfig to use with dependency-tree (see below)"}],"tagName":"span","properties":{"className":["token","comment"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"const"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" tsConfig "},{"children":[{"children":[],"type":"text","value":"="}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" path"},{"children":[{"children":[],"type":"text","value":"."}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"resolve"}],"tagName":"span","properties":{"className":["token","function"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"__dirname"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"tsconfig-dependency-tree.json\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n\n  "},{"children":[{"children":[],"type":"text","value":"// Now package your lambdas"}],"tagName":"span","properties":{"className":["token","comment"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"const"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" layeredLambdas "},{"children":[{"children":[],"type":"text","value":"="}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"await"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[{"children":[],"type":"text","value":"packLayeredLambdas"}],"tagName":"span","properties":{"className":["token","function"]},"type":"element"},{"children":[{"children":[{"children":[],"type":"text","value":"<"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"{"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    helloWorld"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"string"}],"tagName":"span","properties":{"className":["token","builtin"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"}"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":">"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"}],"tagName":"span","properties":{"className":["token","generic","class-name"]},"type":"element"}],"tagName":"span","properties":{"className":["token","generic-function"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"{"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"// We group related lambdas per feature, this identifies the group"}],"tagName":"span","properties":{"className":["token","comment"]},"type":"element"},{"children":[],"type":"text","value":"\n    id"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"my-project-lambdas\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    webpackConfig"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    mode"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" WebpackMode"},{"children":[{"children":[],"type":"text","value":"."}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"production"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    srcDir"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" __dirname"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    outDir"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    Bucket"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" bucketName"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    lambdas"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"{"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n      helloWorld"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" path"},{"children":[{"children":[],"type":"text","value":"."}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"resolve"}],"tagName":"span","properties":{"className":["token","function"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"__dirname"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"hello-world.ts\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"}"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    tsConfig"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"}"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n\n  "},{"children":[{"children":[],"type":"text","value":"// And create the base layer"}],"tagName":"span","properties":{"className":["token","comment"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"const"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" baseLayer "},{"children":[{"children":[],"type":"text","value":"="}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"await"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"packBaseLayer"}],"tagName":"span","properties":{"className":["token","function"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"{"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    srcDir"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" __dirname"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    outDir"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    Bucket"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" bucketName"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"}"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n\n  "},{"children":[{"children":[],"type":"text","value":"// Now you can construct your CDK app and pass the locations"}],"tagName":"span","properties":{"className":["token","comment"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"// of the layered lambdas and the base layer location in,"}],"tagName":"span","properties":{"className":["token","comment"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"// to use them when constructing a Lambda function definition"}],"tagName":"span","properties":{"className":["token","comment"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"new"}],"tagName":"span","properties":{"className":["token","keyword"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"MyCDKApp"}],"tagName":"span","properties":{"className":["token","class-name"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"layeredLambdas"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":" baseLayer"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"."}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"run"}],"tagName":"span","properties":{"className":["token","function"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"}"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"("}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":")"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":";"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"}],"tagName":"code","properties":{"className":["language-typescript"]},"type":"element"}],"tagName":"pre","properties":{"className":["language-typescript"]},"type":"element"}],"tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"typescript"},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[{"children":[],"tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"type":"element"}],"tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"type":"element"}],"tagName":"a","properties":{"href":"#tsconfig-webpackjson","ariaLabel":"tsconfig webpackjson permalink","className":["anchor","before"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"tsconfig-webpack.json"}],"tagName":"code","properties":{},"type":"element"}],"tagName":"h3","properties":{"id":"tsconfig-webpackjson","style":"position:relative;"},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[{"children":[{"children":[],"type":"text","value":"{"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"\"compilerOptions\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"{"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"module\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"commonjs\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"target\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"es2017\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"strict\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"true"}],"tagName":"span","properties":{"className":["token","boolean"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"declaration\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"false"}],"tagName":"span","properties":{"className":["token","boolean"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"skipLibCheck\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"true"}],"tagName":"span","properties":{"className":["token","boolean"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"noUnusedParameters\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"true"}],"tagName":"span","properties":{"className":["token","boolean"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"noUnusedLocals\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"true"}],"tagName":"span","properties":{"className":["token","boolean"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"}"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"\"include\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"["}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"\"**/*.ts\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"]"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"}"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"}],"tagName":"code","properties":{"className":["language-json"]},"type":"element"}],"tagName":"pre","properties":{"className":["language-json"]},"type":"element"}],"tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"json"},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[{"children":[],"tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"type":"element"}],"tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"type":"element"}],"tagName":"a","properties":{"href":"#tsconfig-dependency-treejson","ariaLabel":"tsconfig dependency treejson permalink","className":["anchor","before"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"tsconfig-dependency-tree.json"}],"tagName":"code","properties":{},"type":"element"}],"tagName":"h3","properties":{"id":"tsconfig-dependency-treejson","style":"position:relative;"},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[{"children":[{"children":[],"type":"text","value":"{"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"\"compilerOptions\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"{"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"module\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"commonjs\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"target\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"es2017\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"lib\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"["}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"\"es2017\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"]"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"strict\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"true"}],"tagName":"span","properties":{"className":["token","boolean"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"outDir\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"\"dist/\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"declaration\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"false"}],"tagName":"span","properties":{"className":["token","boolean"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"skipLibCheck\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"true"}],"tagName":"span","properties":{"className":["token","boolean"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"noUnusedParameters\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"true"}],"tagName":"span","properties":{"className":["token","boolean"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n    "},{"children":[{"children":[],"type":"text","value":"\"noUnusedLocals\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"true"}],"tagName":"span","properties":{"className":["token","boolean"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"}"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":","}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n  "},{"children":[{"children":[],"type":"text","value":"\"include\""}],"tagName":"span","properties":{"className":["token","property"]},"type":"element"},{"children":[{"children":[],"type":"text","value":":"}],"tagName":"span","properties":{"className":["token","operator"]},"type":"element"},{"children":[],"type":"text","value":" "},{"children":[{"children":[],"type":"text","value":"["}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"\"**/*.ts\""}],"tagName":"span","properties":{"className":["token","string"]},"type":"element"},{"children":[{"children":[],"type":"text","value":"]"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"}"}],"tagName":"span","properties":{"className":["token","punctuation"]},"type":"element"}],"tagName":"code","properties":{"className":["language-json"]},"type":"element"}],"tagName":"pre","properties":{"className":["language-json"]},"type":"element"}],"tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"json"},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"If you would like to see a working example with AWS CDK,\n"},{"children":[{"children":[],"type":"text","value":"ping me"}],"tagName":"a","properties":{"href":"https://twitter.com/coderbyheart","target":"_blank","rel":["nofollow","noreferrer"]},"type":"element"},{"children":[],"type":"text","value":" or leave a comment below. As always,\nI'd love to get your feedback on how "},{"children":[{"children":[],"type":"text","value":"you"}],"tagName":"em","properties":{},"type":"element"},{"children":[],"type":"text","value":" solve this in your project, too!"}],"tagName":"p","properties":{},"type":"element"}],"type":"root","data":{"quirksMode":false}},"frontmatter":{"title":"How I package TypeScript lambdas for AWS","subtitle":"Serverless","noheadline":null,"date":"2019-04-25T17:00+02:00","abstract":"The latest (and greatest?) way I could come up to publish AWS Lambdas written in TypeScript.","lang":null},"headings":[{"id":"external-dependencies-in-a-layer","depth":2,"value":"External dependencies in a layer"},{"id":"tree-shaking-on-inter-repo-dependencies","depth":2,"value":"Tree-Shaking on inter-repo dependencies"},{"id":"deploy-only-if-changed","depth":2,"value":"Deploy only if changed"},{"id":"cache-on-s3","depth":2,"value":"Cache on S3"},{"id":"source-code-and-usage-in-aws-cdk","depth":2,"value":"Source code and usage in AWS CDK"},{"id":"cloudformationts","depth":3,"value":"cloudformation.ts"},{"id":"tsconfig-webpackjson","depth":3,"value":"tsconfig-webpack.json"},{"id":"tsconfig-dependency-treejson","depth":3,"value":"tsconfig-dependency-tree.json"}]}},"Footer":{"id":"cfe5b9e2-511c-5615-992a-dab82e1f8ed7","name":"Footer","relativeDirectory":"","relativePath":"Footer.md","remark":{"htmlAst":{"children":[{"children":[{"children":[],"type":"text","value":"Software Crafter building ðŸŒ©ï¸ cloud-based cellular IoT solutions at\n"},{"children":[{"children":[],"type":"text","value":"Nordic Semiconductor"}],"tagName":"a","properties":{"href":"https://nordicsemi.com/","target":"_blank","rel":["nofollow","noreferrer"]},"type":"element"},{"children":[],"type":"text","value":"."},{"children":[],"tagName":"br","properties":{},"type":"element"},{"children":[],"type":"text","value":"\nMentor. Speaker. Conference & Community builder. Camper. ðŸ•ï¸ ðŸš"}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[{"children":[],"tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"type":"element"}],"tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"type":"element"}],"tagName":"a","properties":{"href":"#markus-tacker","ariaLabel":"markus tacker permalink","className":["anchor","before"]},"type":"element"},{"children":[],"type":"text","value":"Markus Tacker"}],"tagName":"h2","properties":{"id":"markus-tacker","style":"position:relative;"},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[],"type":"text","value":"Media Computer Scientist (B.Sc.)"}],"tagName":"strong","properties":{},"type":"element"}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"ðŸ“¨ "},{"children":[{"children":[],"type":"text","value":"m@coderbyheart.com"}],"tagName":"a","properties":{"href":"mailto:m@coderbyheart.com","target":"_blank","rel":["nofollow","noreferrer"]},"type":"element"}],"tagName":"li","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"}],"tagName":"ul","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[{"children":[],"tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"type":"element"}],"tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"type":"element"}],"tagName":"a","properties":{"href":"#connect","ariaLabel":"connect permalink","className":["anchor","before"]},"type":"element"},{"children":[],"type":"text","value":"Connect"}],"tagName":"h2","properties":{"id":"connect","style":"position:relative;"},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"You can find me on these sites."}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[],"type":"text","value":"Please note that I will reject connection requests from people I've never met\npersonally."}],"tagName":"em","properties":{},"type":"element"}],"tagName":"p","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[],"type":"text","value":"Mastodon"}],"tagName":"a","properties":{"rel":["me"],"href":"https://chaos.social/@coderbyheart","title":"Markus Tacker on Mastodon"},"type":"element"}],"tagName":"li","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[],"type":"text","value":"Matrix"}],"tagName":"a","properties":{"rel":["me"],"href":"https://matrix.to/#/@coderbyheart:matrix.im","title":"Markus Tacker on Matrix"},"type":"element"}],"tagName":"li","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[],"type":"text","value":"LinkedIn"}],"tagName":"a","properties":{"rel":["me"],"href":"https://www.linkedin.com/in/markustacker","title":"Markus Tacker on LinkedIn"},"type":"element"}],"tagName":"li","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[],"type":"text","value":"GitHub"}],"tagName":"a","properties":{"rel":["me"],"href":"https://github.com/coderbyheart","title":"Markus Tacker on GitHub"},"type":"element"}],"tagName":"li","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"},{"children":[{"children":[{"children":[],"type":"text","value":"Instagram"}],"tagName":"a","properties":{"rel":["me"],"href":"https://www.instagram.com/coderbyheart/","title":"Markus Tacker on Instagram"},"type":"element"}],"tagName":"li","properties":{},"type":"element"},{"children":[],"type":"text","value":"\n"}],"tagName":"ul","properties":{},"type":"element"}],"type":"root","data":{"quirksMode":false}},"frontmatter":{"title":"","subtitle":null,"noheadline":null,"date":null,"abstract":null,"lang":null},"headings":[{"id":"markus-tacker","depth":2,"value":"Markus Tacker"},{"id":"connect","depth":2,"value":"Connect"}]}},"pagePath":"/how-i-package-typescript-lambdas-for-aws"}},"staticQueryHashes":[]}